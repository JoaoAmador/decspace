<!DOCTYPE html>
<html>
  <head>
    <title>DecSpace: Workspace - Projects</title>

    <meta name = 'viewport' content = 'width = device-width, initial-scale = 1'>

    <!-- CSS Stylesheet -->
    <link rel = 'stylesheet' type = 'text/css' href = '../../css/index.css'/>
    <link rel = 'stylesheet' type = 'text/css' href = '../../css/workspace.css'/>

    <!-- jQuery -->
    <script type = 'text/javascript' src = '../../js/shared/jquery-3.1.0.js'></script>
    <script type = 'text/javascript' src = '../../js/shared/jquery-ui-1.12.0/jquery-ui.js'></script>

    <!-- AngularJS -->
    <script src = '../../js/shared/angular.min.js'></script>

    <!-- AngularJS Modules -->
    <script src = '../../js/app.js'></script>

    <!-- AngularJS Controllers -->
    <script src = '../../js/controllers/workspace/WorkspaceController.js'></script>

    <!-- Bootstrap -->
    <link rel = 'stylesheet' href = '../../js/shared/bootstrap-3.3.7-dist/css/bootstrap.min.css'/>
    <script type = 'text/javascript' src = '../../js/shared/bootstrap-3.3.7-dist/js/bootstrap.js'></script>

    <!-- Google Web Fonts -->
    <link href = 'https://fonts.googleapis.com/css?family=Open+Sans:400,600i' rel = 'stylesheet'>

    <!-- Font Awesome -->
    <link rel = 'stylesheet' href = '../../js/shared/font-awesome-4.7.0/css/font-awesome.css'></link>

    <!-- ng-draggable module -->
    <script src = '../../js/shared/ng-draggable/ngDraggable.js'></script>

    <!-- InteractJS -->
    <script type = 'text/javascript' src = '../../js/shared/interact.js'></script>
  </head>

  <body ng-app = 'decspace' ng-controller = 'WorkspaceController'>

    <!-- Navigation Bar -->
    <nav class = 'navbar navbar-custom navbar-fixed-top'>
      <div class = 'container'>
        <!-- Title -->
        <div class = 'navbar-header'>
          <a class = 'navbar-brand' href = '../dashboard/dashboard.html'>DecSpace</a>
        </div>

        <!-- About, FAQ and Contact Us links. Sign Up and Log In buttons. -->
        <ul class = 'nav navbar-nav navbar-right'>
          <li><p class = 'navbar-text' style = 'font-weight: 600; font-style: italic'>Welcome, {{name}}!</p></li>

          <li><a href = '../homepage/about.html'>About</a></li>

          <li><a href = '../homepage/faq.html'>FAQ</a></li>

          <li><a href = '../homepage/contactus.html'>Contact Us</a></li>

          <li>
            <button type = 'button' class = 'btn btn-default navbar-btn' ng-click = 'logOut()'>
              <span class = 'glyphicon glyphicon-log-out'></span>
              Log Out
            </button>
          </li>
        </ul>

      </div>
    </nav>

    <div id = 'main-content' class = 'container'>

      <ul class = 'breadcrumb'>
        <li><a href = '../dashboard/dashboard.html'>Dashboard</a></li>
        <li><a href = 'projects.html'>Workspace - Projects</a></li>
        <li class = 'active'>Workspace - Project {{project_name}}</li>
      </ul>

      <p class = 'header-1'>Workspace - Project {{project_name}}</p>

      <br>

      <div class = 'row'>
        <div class = 'col-md-2' ></div>

        <!-- Workspace -->
        <div id = 'workspace' class = 'col-md-8' style = 'height: 400px; border: black 1px solid'>

          <!-- Button Bar -->
          <div class = 'btn-toolbar' role = 'toolbar' style = 'margin-top: 1%'>
            <div class = 'btn-group' role = 'group'>
              <!-- Execute Button -->
              <button type = 'button' class = 'btn btn-default' ng-click = '' title = 'Execute Project'>
                <span class = 'glyphicon glyphicon-play'></span>
              </button>
            </div>

            <div class = 'btn-group' role = 'group'>
              <!-- Save Button -->
              <button type = 'button' class = 'btn btn-primary' ng-click = 'saveData()' title = 'Save Data'>
                <span class = 'glyphicon glyphicon-floppy-save icon-large'></span>
              </button>

              <!-- Reload Data Button -->
              <button type = 'button' class = 'btn btn-info' ng-click = 'reloadData()' title = 'Reload Data'>
                <span class = 'glyphicon glyphicon-refresh'></span>
              </button>
            </div>

            <div class = 'btn-group' role = 'group'>
              <!-- Import Button -->
              <button type = 'button' class = 'btn btn-warning' title = 'Import Data' data-toggle = 'modal' data-target = '#import-modal'>
                <span class = 'glyphicon glyphicon-import icon-large'></span>
              </button>
            </div>
          </div>

          <!-- Alerts -->
          <div class = 'alert alert-success custom-alert' id = 'save-success' ng-cloak>
            Data <strong>successfully</strong> saved.
          </div>

          <div class = 'alert alert-danger custom-alert' id = 'invalid-connection1' ng-cloak>
            <strong>Invalid connection</strong> - Input Points should be connected to Output Points.
          </div>

          <div class = 'alert alert-danger custom-alert' id = 'invalid-connection2' ng-cloak>
            <strong>Invalid connection</strong> - Only points of different modules should be connected.
          </div>

          <div class = 'alert alert-danger custom-alert' id = 'invalid-connection3' ng-cloak>
            <strong>Invalid connection</strong> - That connection already exists.
          </div>

          <!-- SVG Area -->
          <svg id = 'svg' width = '100%' height = '100%'>

            <!-- Import Modal -->
            <div class = 'modal fade' id = 'import-modal' role = 'dialog'>
              <div class = 'modal-dialog'>
                <div class = 'modal-content'>
                  <div class = 'modal-header'>
                    <button type = 'button' class = 'close' data-dismiss = 'modal'>&times;</button>
                    <h4 class = 'modal-title'>Import Data</h4>
                  </div>
                  <div class = 'modal-body'>

                    <div class = 'row'>
                      <div class = 'col-md-4'></div>
                      <input id = 'input-files' type = 'file' multiple>
                    </div>

                    <br>

                    <div class = 'row'>
                      <div class = 'col-md-5'></div>
                      <button type = 'button' class = 'btn btn-primary col-md-2' ng-click = 'importData()' data-dismiss = 'modal'>
                        Import
                      </button>
                    </div>

                    <p><sub>CSV and JSON formats are accepted.</sub></p>

                  </div>
                </div>
              </div>
            </div>

            <!-- Module Modals -->

            <!-- Input File Modal -->
            <div id = 'inputfile-modal' class = 'modal fade custom-modal' role = 'dialog'>
              <div class = 'modal-dialog'>
                <div class = 'modal-content'>

                  <div class = 'modal-header'>
                    <button type = 'button' class = 'close' data-dismiss = 'modal'>&times;</button>
                    <h4 class = 'modal-title'>Input File</h4>
                  </div>

                  <div class = 'modal-body'>
                    <div class = 'row'>
                      <button type = 'button' class = 'btn btn-danger' ng-click = 'deleteCurrentModule()' title = 'Delete Module' style = 'margin-left: -94%'>
                        <span class = 'glyphicon glyphicon-trash'></span>
                      </button>
                    </div>

                    <p class = 'header-1'>Data</p>

                    <table class = 'table table-bordered table-hover'>
                      <thead>
                        <tr>
                          <th class = 'text-center' ng-repeat = '(key, value) in currentModule.data[0]'>{{key}}</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr ng-repeat = 'item in currentModule.data'>
                          <td ng-repeat = '(key, value) in item'>{{value}}</td>
                        </tr>
                      </tbody>
                    </table>

                  </div>
                </div>
              </div>
            </div>

            <!-- OrderBy Modal -->
            <div id = 'orderby-modal' class = 'modal fade custom-modal'  role = 'dialog'>
              <div class = 'modal-dialog'>
                <div class = 'modal-content'>

                  <div class = 'modal-header'>
                    <button type = 'button' class = 'close' data-dismiss = 'modal'>&times;</button>
                    <h4 class = 'modal-title'>OrderBy Method</h4>
                  </div>

                  <div class = 'modal-body'>
                    <div class = 'row'>
                      <button type = 'button' class = 'btn btn-danger' ng-click = 'deleteCurrentModule()' title = 'Delete Module' style = 'margin-left: -94%'>
                        <span class = 'glyphicon glyphicon-trash'></span>
                      </button>
                    </div>

                    <!-- Criteria -->
                    <p class = 'header-1'>Criteria</p>

                    <table class = 'table table-bordered table-hover'>
                      <thead>
                        <tr>
                          <th class = 'text-center'>Order By</th>
                          <th class = 'text-center'>Criterion Name</th>
                          <th class = 'text-center'>Type</th>
                          <th class = 'text-center'>Direction</th>
                          <th class = 'col-md-2'></th>
                        </tr>
                      </thead>
                      <!-- Added Criteria -->
                      <tbody>
                        <tr ng-repeat = 'criterion in currentModule.criteria' ng-class = '{danger: criterion.id == deleteIdOrderByCriterion}'>
                          <td>
                            <input type = 'radio' ng-checked = 'criterion.selected == true' ng-click = 'selectOrderByCriterion(criterion)'>
                          </td>
                          <td>
                            <input class = 'form-control' type = 'text' ng-model = 'criterion.name'>
                          </td>
                          <td>
                            <select ng-model = 'criterion.type'>
                              <option value = '' disabled>--- Please Select ---</option>
                              <option>Text</option>
                              <option>Number</option>
                            </select>
                          </td>
                          <td>
                            <select ng-model = 'criterion.direction'>
                              <option value = '' disabled>--- Please Select ---</option>
                              <option>Ascendant</option>
                              <option>Descendant</option>
                            </select>
                          </td>
                          <td ng-if = 'criterion.id != deleteIdOrderByCriterion'>
                            <button type = 'button' class = 'btn btn-danger' ng-click = 'deleteOrderByCriterion(criterion)' title = 'Delete Criterion'>
                              <span class = 'glyphicon glyphicon-minus'></span>
                            </button>
                          </td>
                          <td ng-if = 'criterion.id == deleteIdOrderByCriterion'>
                            <button type = 'button' class = 'btn btn-success' ng-click = 'confirmDeleteOrderByCriterion(criterion)' title = 'Confirm Delete Criterion'>
                              <span class = 'glyphicon glyphicon-ok'></span>
                            </button>
                            <button type = 'button' class = 'btn btn-danger' ng-click = 'cancelDeleteOrderByCriterion()' title = 'Cancel Delete Criterion'>
                              <span class = 'glyphicon glyphicon-remove'></span>
                            </button>
                          </td>
                        </tr>
                        <!-- Form to add criteria -->
                        <tr class = 'active'>
                          <td></td>
                          <td>
                            <input class = 'form-control' type = 'text' ng-model = 'new_criterion.name'>
                          </td>
                          <td>
                            <select ng-model = 'new_criterion.type'>
                              <option value = '' disabled>--- Please Select ---</option>
                              <option>Text</option>
                              <option>Number</option>
                            </select>
                          </td>
                          <td>
                            <select ng-model = 'new_criterion.direction'>
                              <option value = '' disabled>--- Please Select ---</option>
                              <option>Ascendant</option>
                              <option>Descendant</option>
                            </select>
                          </td>
                          <td>
                            <button type = 'button' class = 'btn btn-success' ng-click = 'addOrderByCriterion()' title = 'Add Criterion'>
                              <span class = 'glyphicon glyphicon-plus'></span>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </table>

                    <!-- Actions -->
                    <p class = 'header-1'>Actions</p>

                    <table class = 'table table-bordered table-hover'>
                      <thead>
                        <th class = 'text-center'>Action Name</th>
                        <th class = 'text-center' ng-repeat = 'criterion in currentModule.criteria'>{{criterion.name}}</th>
                        <th class = 'col-md-2'></th>
                      </thead>
                      <tbody>
                        <tr ng-repeat = 'action in currentModule.actions' ng-class = '{danger: action.id == deleteIdOrderByAction}'>
                          <td>
                            <input class = 'form-control' type = 'text' ng-model = 'action.name'>
                          </td>
                          <td ng-repeat = 'criterion in currentModule.criteria'>
                            <input class = 'form-control' ng-model = 'action[criterion.name]'>
                          </td>
                          <td ng-if = 'action.id != deleteIdOrderByAction'>
                            <button type = 'button' class = 'btn btn-danger btn-action-remove' ng-click = 'deleteOrderByAction(action)' title = 'Delete Action'>
                              <span class = 'glyphicon glyphicon-minus'></span>
                            </button>
                          </td>
                          <td ng-if = 'action.id == deleteIdOrderByAction'>
                            <button type = 'button' class = 'btn btn-success' ng-click = 'confirmDeleteOrderByAction(action)' title = 'Confirm Delete Action'>
                              <span class = 'glyphicon glyphicon-ok'></span>
                            </button>
                            <button type = 'button' class = 'btn btn-danger' ng-click = 'cancelDeleteOrderByAction()' title = 'Cancel Delete Action'>
                              <span class = 'glyphicon glyphicon-remove'></span>
                            </button>
                          </td>
                        </tr>
                        <!-- Form to add action -->
                        <tr class = 'active'>
                          <td>
                            <input class = 'form-control' type = 'text' ng-model = 'new_action.name'>
                          </td>
                          <td ng-repeat = 'criterion in currentModule.criteria'>
                            <input class = 'form-control' ng-model = 'new_action[criterion.name]'>
                          </td>
                          <td>
                            <button type = 'button' class = 'btn btn-success btn-action-add' ng-click = 'addOrderByAction()' title = 'Add Action'>
                              <span class = 'glyphicon glyphicon-plus'></span>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                </div>
              </div>
            </div>

            <!-- Module Templates -->

            <!-- Input File Template -->
            <template id = 'inputfile-temp'>
              <div id = 'inputfile' class = 'module-template module-inputfile draggable' style = 'position:absolute; margin-top: 100%'>
                <a href class = 'module-circle-anchor' data-toggle = 'modal' data-target = '#inputfile-modal' ng-click = 'selectCurrentModule($event)' style = 'position: absolute; margin-top: -5%; margin-left: -20%'></a>

                <button id = 'inputfile-output' type = 'button' class = 'module-circle module-circle-output' ng-click = 'drawLine($event)' style = 'margin-top: 7%; margin-left: 42%'></button>
                <span class = 'module-circle-span' style = 'margin-left: 20%; margin-top: 5%'>Output</span>
              </div>
            </template>

            <!-- OrderBy Template -->
            <template id = 'orderby-temp'>
              <div id = 'orderby' class = 'module-template draggable'>
                <a href class = 'module-circle-anchor' data-toggle = 'modal' data-target = '#orderby-modal' ng-click = 'selectCurrentModule($event)'>OrderBy</a>

                <button id = 'orderby-criteria' type = 'button' class = 'module-circle module-circle-input' ng-click = 'drawLine($event)' style = 'margin-top: -10%; margin-left: -65%'></button>
                <span class = 'module-circle-span' style = 'margin-top: -11%; margin-left: -57%'>Criteria</span>

                <button id = 'orderby-actions' type = 'button' class = 'module-circle module-circle-input' ng-click = 'drawLine($event)' style = 'margin-top: 20%; margin-left: -65%'></button>
                <span class = 'module-circle-span' style = 'margin-top: 19%; margin-left: -57%'>Actions</span>

                <button id = 'orderby-output' type = 'button' class = 'module-circle module-circle-output' ng-click = 'drawLine($event)' style = 'margin-top: 25%; margin-left: 25%'></button>
                <span class = 'module-circle-span' style = 'margin-left: 3%; margin-top: 23%'>Output</span>
              </div>
            </template>

          </svg>
        </div>

        <!-- Modules List -->
        <div class = 'col-md-2'>
          <div class = 'panel-group'>
            <div class = 'panel panel-default'>
              <div class = 'panel-heading'>
                <h4 class = 'panel-title'>
                  <a data-toggle = 'collapse' href = '#collapse1'>Methods</a>
                </h4>
              </div>

              <div id = 'collapse1' class = 'panel-collapse collapse'>
                <ul class = 'list-group'>
                  <li class = 'list-group-item' ng-repeat = 'method in methods' ng-click = 'createModule(method)'>
                    <a href = ''>{{method}}</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </body>
</html>
